{{define "title"}}Admin Orders{{end}}

{{define "content"}}
<h1 class="text-3xl font-bold mb-6 text-gray-800">ðŸ“¦ Orders</h1>

<!-- Error Message -->
{{if .Error}}
<div class="mb-4 p-4 bg-red-50 border-l-4 border-red-400 text-red-700 rounded-lg shadow-sm">
  <p class="font-semibold">Error</p>
  <p class="text-sm">{{.Error}}</p>
</div>
{{end}}

<div class="overflow-x-auto bg-white shadow-lg rounded-xl border border-gray-100">
  <table class="min-w-full text-sm">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-6 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider text-xs">Order ID</th>
        <th class="px-6 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider text-xs">User</th>
        <th class="px-6 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider text-xs">Email</th>
        <th class="px-6 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider text-xs">Order Date</th>
        <th class="px-6 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider text-xs">Status</th>
        <th class="px-6 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider text-xs">Total</th>
        <th class="px-6 py-3 text-left font-semibold text-gray-600 uppercase tracking-wider text-xs">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-100">
      {{if .Orders}}
        {{range .Orders}}
        <tr class="hover:bg-gray-50 transition">
          <td class="px-6 py-4 font-medium text-gray-800">#{{.OrderID}}</td>
          <td class="px-6 py-4 text-gray-700">{{.UserID}}</td>
          <td class="px-6 py-4 text-gray-700">{{.UserEmail}}</td>
          <td class="px-6 py-4 text-gray-500">{{.OrderDate.Format "2006-01-02 15:04"}}</td>
          <td class="px-6 py-4">
            <span class="px-3 py-1 inline-flex text-xs font-medium rounded-full
              {{if eq .Status "pending"}} bg-yellow-100 text-yellow-800
              {{else if eq .Status "completed"}} bg-green-100 text-green-800
              {{else if eq .Status "cancelled"}} bg-red-100 text-red-800
              {{else}} bg-gray-100 text-gray-800 {{end}}">
              {{.Status}}
            </span>
          </td>
          <td class="px-6 py-4 font-semibold text-gray-900">${{printf "%.2f" .TotalAmount}}</td>
          <td class="px-6 py-4 space-x-2">
            <a href="/admin/orders/{{.OrderID}}" 
               class="px-4 py-1.5 rounded-lg bg-blue-500 text-white text-xs font-medium hover:bg-blue-600 transition shadow-sm">
               View
            </a>
          </td>
        </tr>

        <!-- Expandable Details Row -->
        <tr class="bg-gray-50">
          <td colspan="7" class="px-6 py-5">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm">
              
              <!-- Address -->
              <div class="bg-white rounded-lg border p-4 shadow-sm">
                <h3 class="font-semibold text-gray-800 mb-2">Shipping Address</h3>
                <p class="text-gray-600">
                  {{.Address.Street}}, {{.Address.City}}, {{.Address.State}}, 
                  {{.Address.ZipCode}}, {{.Address.Country}}
                </p>
              </div>

              <!-- Items -->
              <div class="bg-white rounded-lg border p-4 shadow-sm">
                <h3 class="font-semibold text-gray-800 mb-2">Items</h3>
                <ul class="list-disc ml-5 space-y-1 text-gray-600">
                  {{range .Items}}
                  <li>
                    <span class="font-medium text-gray-800">{{.ProductID}}</span> â€“ 
                    Qty: {{.Quantity}}, 
                    Unit: ${{printf "%.2f" .UnitPrice}}, 
                    Subtotal: ${{printf "%.2f" .Subtotal}}
                  </li>
                  {{end}}
                </ul>
              </div>

              <!-- Payment -->
              <div class="bg-white rounded-lg border p-4 shadow-sm">
                <h3 class="font-semibold text-gray-800 mb-2">Payment</h3>
                <p class="text-gray-600">
                  Method: <span class="font-medium">{{.Payment.Method}}</span><br>
                  Amount: ${{printf "%.2f" .Payment.Amount}}<br>
                  Status: <span class="capitalize">{{.Payment.Status}}</span>
                </p>
              </div>
            </div>
          </td>
        </tr>
        {{end}}
      {{else}}
      <tr>
        <td colspan="7" class="px-6 py-10 text-center text-gray-500 italic">No orders found.</td>
      </tr>
      {{end}}
    </tbody>
  </table>
</div>
{{end}}
